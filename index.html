<!doctype html>
<html>
<style type="text/css">

iframe
{
	width: 70%;
}

html, body
{
	width: 100%;
	height: 100%;
	margin: 30px;
}

#container 
{
	width: 50%;
	height: 50%;
	margin: 0;
	padding: 0;
}

</style>
<head>
	<title>API Test</title>
	<meta charset="utf-8"/>
	<script>
		// array = [];
		function getData() 
		{
 			request = new XMLHttpRequest();
			request.open("GET", "https://covidtracking.com/api/states/daily");
			request.onreadystatechange = function() 
			{
				if (request.readyState == 4 && request.status == 200) 
				{
					result = request.responseText;
					// alert(result);
					data = JSON.parse(result);
					for (i = 0; i < 56; i++) {
						// array[data[i]["state"]] = data[i]
						if (data[i]["state"] !== "AS") {
							document.getElementById("data").innerHTML += (data[i]["state"] + ": " + data[i]["positive"] + " positive cases, " + data[i]["positiveIncrease"] + " more positive cases since yesterday, " + data[i]["death"] + " total deaths, " + data[i]["deathIncrease"] + " more deaths since yesterday </br>");
						}
					}

				}
			}

			request.send();
		}
		
		function sortBy()
		{
			data = document.getElementById("data").innerHTML;
			state = data.split("<br>");
			//alert(state[0]);
			//values = state[0].match(/\d+/g);
			//alert(values);
			arr = [];
			for (i = 0; i < 55; i++) {
				values = state[i].match(/\d+/g);
				values.push(state[i]);
				values.push(i);
				arr.push(values);
			}
			//console.log(arr);

			if (document.getElementById("sort").value == "Total Positive Cases") {
				for(i = 0; i < 55; i++){
       				 for(j = i+1; j < 55; j++){
            			if(arr[i][0] > arr[j][0]){
                			temp = arr[i];
                			arr[i] = arr[j];
                			arr[j] = temp;
            			}
        			}
    			}
    			console.log(arr);
    			document.getElementById("data").innerHTML = null;
    			for (i = 0; i < 55; i++){
    				document.getElementById("data").innerHTML += arr[i][4] + "<br>";
    			}
			}
				 
		}
	

	</script>
</head>
<body onload="getData()">
	<h1>API Test</h1>
	<form>
		<select id="sort" onchange="sortBy()">
			<option>Sort By</option>
			<option>Total Positive Cases</option>
			<option>Daily Positive Case Increase</option>
			<option>Total Deaths</option>
			<option>Daily Death Increase</option>
		</select>
	</form>


	<div id="data"></div>

	<iframe src="https://createaclickablemap.com/map.php?&id=90766&maplocation=false&online=true" width="900" height="525" style="border: none;"></iframe>
	
	<script src="https://cdn.anychart.com/releases/8.0.0/js/anychart-base.min.js"></script>
	<div id="container"></div>

	<script>
        anychart.onDocumentReady(function() 
        {
		    // set the data
		    var data = {
		    	header: ["Name", "Death toll"],
		      	rows: 
		      		[["San-Francisco (1906)", 1500],
			         ["Messina (1908)", 87000],
			         ["Ashgabat (1948)", 175000],
			         ["Chile (1960)", 10000],
			         ["Tian Shan (1976)", 242000],
			         ["Armenia (1988)", 25000],
			         ["Iran (1990)", 50000]]
	           };

			// create the chart
			var chart = anychart.column();
			chart.normal().fill("#425957");
			
			// add data
			chart.data(data);

			// set the chart title
			chart.title("The deadliest earthquakes in the XXth century");

			// draw
			chart.container("container");
			chart.draw();
		});
    </script>


	<script>if (window.addEventListener){ window.addEventListener("message", function(event) { if(event.data.length >= 22) { if( event.data.substr(0, 22) == "__MM-LOCATION.REDIRECT") location = event.data.substr(22); } }, false); } else if (window.attachEvent){ window.attachEvent("message", function(event) { if( event.data.length >= 22) { if ( event.data.substr(0, 22) == "__MM-LOCATION.REDIRECT") location = event.data.substr(22); } }, false); } </script>



</body>
</html>